{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"YDMS Composite Actions","text":"<p>This is the documentation for the GitHub Composite actions currently being in use at YDMS.</p>"},{"location":"#table-of-contents","title":"Table of Contents","text":""},{"location":"#composite-actions","title":"Composite Actions","text":"<ul> <li>Unity Download</li> <li>CMake Build</li> <li>Docker Build Push</li> <li>.NET Build</li> <li>.NET Build Push</li> <li>.NET Run Tests</li> </ul>"},{"location":"#live-production","title":"Live Production","text":"<p>The repositories listed here are using those composite Actions:</p> <ul> <li>ResoniteLink</li> </ul>"},{"location":"composite/cmake-build/","title":"CMake Build","text":"<p>This Composite Action installs then builds a CMake project.</p>"},{"location":"composite/cmake-build/#.github/actions/cmake-build","title":"CMake Run and Build Composite Action","text":"<pre><code>- uses: Yellow-Dog-Man/composite-actions-templates/.github/actions/cmake-build@main\n  with:\n    outdir: (1)\n    working-dir: (2)\n</code></pre> <ol> <li><p>Output directory of the build</p></li> <li><p>Working directory for the build</p></li> </ol> <p>Will install CMake then build the current project with it.</p> <p> Inputs: \u00a4 </p> Name Description Default <code>outdir</code> <p>Output directory of the build</p> <code>cmake-version</code> <p>Version of CMake to install and use</p> <code>latest</code> <code>working-dir</code> <p>Working directory for the build</p> <code>cmake-args</code> <p>Additional arguments to pass to cmake</p> <code></code> <code>build-cores</code> <p>How many cores to use during compilation</p> <code>4</code> Source of <code>Yellow-Dog-Man/composite-actions-templates/.github/actions/cmake-build@main</code> <pre><code>name: 'CMake Run and Build Composite Action'\ndescription: 'Will install CMake then build the current project with it.'\n\ninputs:\n  outdir:\n    description: 'Output directory of the build'\n    required: true\n  cmake-version:\n    description: 'Version of CMake to install and use'\n    required: false\n    default: 'latest'\n  working-dir:\n    description: 'Working directory for the build'\n    required: true\n  cmake-args:\n    description: 'Additional arguments to pass to cmake'\n    default: ''\n    required: false\n  build-cores:\n    description: 'How many cores to use during compilation'\n    # Only change this value on self-managed runners\n    # Default GitHub runners only 4 cores\n    default: '4'\n    required: false\n\nruns:\n  using: composite\n  steps:\n    - name: 'Install CMake'\n      uses: lukka/get-cmake@latest\n      with:\n        cmakeVersion: ${{ inputs.cmake-version }}\n\n    - name: 'Make working directory'\n      shell: bash\n      run: mkdir ${{ inputs.working-dir }}\n\n    - name: 'Run CMake build'\n      working-directory: ${{ inputs.working-dir }}\n      shell: bash\n      run: cmake ${{ inputs.cmake-args }} ..\n\n    - name: 'Build solution via CMake'\n      working-directory: ${{ inputs.working-dir }}\n      shell: bash\n      run: make -j${{ inputs.build-cores }}\n</code></pre>"},{"location":"composite/docker-build-push/","title":"Docker build push","text":"<p>This Action builds then pushes a Docker container from the repository.</p>"},{"location":"composite/docker-build-push/#.github/actions/docker-build-push","title":"Docker build push","text":"<pre><code>- uses: Yellow-Dog-Man/composite-actions-templates/.github/actions/docker-build-push@main\n  with:\n    docker-token: (1)\n</code></pre> <ol> <li><p>Docker auth token for the registry.</p></li> </ol> <p>Builds a Docker container and pushes it to the specified registry.</p> <p> Inputs: \u00a4 </p> Name Description Default <code>docker-version</code> <p>Docker version to install.</p> <code>latest</code> <code>docker-registry</code> <p>Registry which Docker will push to.</p> <code>ghcr.io</code> <code>docker-token</code> <p>Docker auth token for the registry.</p> <code>dockerfile-path</code> <p>Path to the Dockerfile file.</p> <code>${{ github.workspace }}/Dockerfile</code> <code>docker-context-path</code> <p>Context to pass to the Docker daemon for the build.</p> <code>.</code> <code>docker-platforms</code> <p>List of platforms to build the image for.</p> <code>linux/amd64</code> Source of <code>Yellow-Dog-Man/composite-actions-templates/.github/actions/docker-build-push@main</code> <pre><code>name: 'Docker build push'\ndescription: 'Builds a Docker container and pushes it to the specified registry.'\n\ninputs:\n  docker-version:\n    description: 'Docker version to install.'\n    default: 'latest'\n    required: false\n  docker-registry:\n    description: 'Registry which Docker will push to.'\n    default: 'ghcr.io'\n    required: false\n  docker-token:\n    description: 'Docker auth token for the registry.'\n    required: true\n  dockerfile-path:\n    description: 'Path to the Dockerfile file.'\n    default: '${{ github.workspace }}/Dockerfile'\n    required: false\n  docker-context-path:\n    description: 'Context to pass to the Docker daemon for the build.'\n    default: '.'\n    required: false\n  docker-platforms:\n    description: 'List of platforms to build the image for.'\n    default: 'linux/amd64'\n    required: false\n\nruns:\n  using: composite\n\n  steps:\n    - name: 'Set QEMU'\n      uses: docker/setup-qemu-action@v3\n\n    - name: 'Setup Buildx'\n      uses: docker/setup-buildx-action@v3\n      with:\n        version: ${{ inputs.docker-version }}\n\n    - name: 'Extract metadata for build'\n      id: metadata\n      uses: docker/metadata-action@v5\n\n    - name: 'Login to registry'\n      uses: docker/login-action@v3\n      with:\n        registry: ${{ inputs.docker-registry }}\n        username: ${{ github.actor }}\n        password: ${{ inputs.docker-token }}\n\n    - name: 'Build and push the image'\n      uses: docker/build-push-action@v6\n      with:\n        context: ${{ inputs.docker-context-path }}\n        file: ${{ inputs.dockerfile-path }}\n        push: 'true'\n        tags: ${{ steps.metadata.outputs.tags }}\n        labels: ${{ steps.metadata.outputs.labels }}\n        platforms: ${{ inputs.docker-platforms }}\n</code></pre>"},{"location":"composite/dotnet-build-push-nuget/","title":".NET Build Push","text":"<p>This Composite Action is used to build, then push a package to a NuGet registry.</p> <p>Do note this forces the type <code>pack</code> of build.</p>"},{"location":"composite/dotnet-build-push-nuget/#.github/actions/dotnet-build-push-nuget","title":".NET Push NuGet","text":"<pre><code>- uses: Yellow-Dog-Man/composite-actions-templates/.github/actions/dotnet-build-push-nuget@main\n  with:\n    dotnet-nuget-auth-token: (1)\n</code></pre> <ol> <li><p>Authentication token for the NuGet registry.</p></li> </ol> <p>Pushes nugets the registry</p> <p> Inputs: \u00a4 </p> Name Description Default <code>dotnet-nuget-out-path</code> <p>Path under which Nugets will be put after the build.</p> <code>${{ github.workspace }}/nupkgs</code> <code>dotnet-nuget-registry-url</code> <p>Publishing URL of the NuGet registry.</p> <code>https://api.nuget.org/v3/index.json</code> <code>dotnet-nuget-auth-token</code> <p>Authentication token for the NuGet registry.</p> Source of <code>Yellow-Dog-Man/composite-actions-templates/.github/actions/dotnet-build-push-nuget@main</code> <pre><code>name: '.NET Push NuGet'\ndescription: 'Pushes nugets the registry'\n\ninputs:\n  dotnet-nuget-out-path:\n    description: 'Path under which Nugets will be put after the build.'\n    default: '${{ github.workspace }}/nupkgs'\n    required: false\n  dotnet-nuget-registry-url:\n    description: 'Publishing URL of the NuGet registry.'\n    default: 'https://api.nuget.org/v3/index.json'\n    required: false\n  dotnet-nuget-auth-token:\n    description: 'Authentication token for the NuGet registry.'\n    required: true\n\nruns:\n  using: composite\n\n  steps:\n    - name: 'Publish package to registry'\n      shell: bash\n      run: dotnet nuget push ${{ inputs.dotnet-nuget-out-path }}/*.nupkg -k ${{ inputs.dotnet-nuget-auth-token }} -s ${{ inputs.dotnet-nuget-registry-url }}\n</code></pre>"},{"location":"composite/dotnet-build/","title":".NET Build","text":"<p>This Composite Action builds a .NET package from the repository.</p>"},{"location":"composite/dotnet-build/#.github/actions/dotnet-build","title":".NET Build","text":"<pre><code>- uses: Yellow-Dog-Man/composite-actions-templates/.github/actions/dotnet-build@main\n</code></pre> <p>Builds a project with .NET.</p> <p> Inputs: \u00a4 </p> Name Description Default <code>dotnet-version</code> <p>.NET version to use</p> <code>10.0.x</code> <code>dotnet-build-args</code> <p>Additional args to pass to the .NET build process</p> <code></code> <code>dotnet-build-type</code> <p>Type of build, pack or build.</p> <code>build</code> <code>dotnet-project-path</code> <p>Path to the .NET project to build.</p> <code>.</code> Source of <code>Yellow-Dog-Man/composite-actions-templates/.github/actions/dotnet-build@main</code> <pre><code>name: '.NET Build'\ndescription: 'Builds a project with .NET.'\n\ninputs:\n  dotnet-version:\n    description: '.NET version to use'\n    default: '10.0.x'\n    required: false\n  dotnet-build-args:\n    description: 'Additional args to pass to the .NET build process'\n    default: ''\n    required: false\n  dotnet-build-type:\n    description: 'Type of build, pack or build.'\n    default: 'build'\n    required: false\n  dotnet-project-path:\n    description: 'Path to the .NET project to build.'\n    default: '.'\n    required: false\n\nruns:\n  using: composite\n\n  steps:\n    - name: 'Install .NET'\n      uses: actions/setup-dotnet@v5\n      with:\n        dotnet-version: ${{ inputs.dotnet-version }}\n\n    - name: 'Build Solution'\n      shell: bash\n      if: ${{ inputs.dotnet-build-type == 'build' }}\n      run: dotnet build -c Release ${{ inputs.dotnet-build-args }} ${{ inputs.dotnet-project-path }}\n\n    - name: 'Pack Solution for NuGET'\n      shell: bash\n      if: ${{ inputs.dotnet-build-type == 'pack' }}\n      run: dotnet pack -c Release ${{ inputs.dotnet-build-args }} ${{ inputs.dotnet-project-path }}\n</code></pre>"},{"location":"composite/dotnet-tests-run/","title":".NET Run Tests","text":"<p>This Composite Action runs whatever tests are set as default for the current Solution.</p>"},{"location":"composite/dotnet-tests-run/#.github/actions/dotnet-tests-run","title":".NET Run Tests","text":"<pre><code>- uses: Yellow-Dog-Man/composite-actions-templates/.github/actions/dotnet-tests-run@main\n</code></pre> <p>Runs the tests of the current Solution.</p> <p> Inputs: \u00a4 </p> Name Description Default <code>dotnet-version</code> <p>The .NET version to install.</p> <code>10.0.x</code> <code>dotnet-project-path</code> <p>Path to the .NET project to test.</p> <code>.</code> Source of <code>Yellow-Dog-Man/composite-actions-templates/.github/actions/dotnet-tests-run@main</code> <pre><code>name: '.NET Run Tests'\ndescription: 'Runs the tests of the current Solution.'\n\ninputs:\n  dotnet-version:\n    description: 'The .NET version to install.'\n    default: '10.0.x'\n    required: false\n  dotnet-project-path:\n    description: 'Path to the .NET project to test.'\n    default: '.'\n    required: false\n\nruns:\n  using: composite\n\n  steps:\n    - name: 'Setup .NET'\n      uses: actions/setup-dotnet@v5\n      with:\n        dotnet-version: ${{ inputs.dotnet-version }}\n\n    - name: 'Run .NET tests'\n      shell: bash\n      run: dotnet test ${{ inputs.dotnet-project-path }}\n</code></pre>"},{"location":"composite/download-from-r2/","title":"Download artifacts from R2","text":"<p>This Composite Action downloads an artifact from Cloudflare R2.</p>"},{"location":"composite/download-from-r2/#.github/actions/download-from-r2","title":"R2 download artifact","text":"<pre><code>- uses: Yellow-Dog-Man/composite-actions-templates/.github/actions/download-from-r2@main\n  with:\n    file-path: (1)\n    r2-storage-bucket: (2)\n    r2-api-id: (3)\n    r2-auth-token-id: (4)\n    r2-auth-token: (5)\n    r2-region: (6)\n    r2-path: (7)\n    put-path: (8)\n</code></pre> <ol> <li><p>Path to the file is.</p></li> <li><p>Storage bucket to use to store the artifacts</p></li> <li><p>Account ID for R2</p></li> <li><p>ID of the authentication token for R2</p></li> <li><p>Authentication token for R2</p></li> <li><p>Region for the R2 account</p></li> <li><p>Path within R2 where to put the file.</p></li> <li><p>File path where to put the files.</p></li> </ol> <p>Downloads an artifact from R2.</p> <p> Inputs: \u00a4 </p> Name Description <code>file-path</code> <p>Path to the file is.</p> <code>r2-storage-bucket</code> <p>Storage bucket to use to store the artifacts</p> <code>r2-api-id</code> <p>Account ID for R2</p> <code>r2-auth-token-id</code> <p>ID of the authentication token for R2</p> <code>r2-auth-token</code> <p>Authentication token for R2</p> <code>r2-region</code> <p>Region for the R2 account</p> <code>r2-path</code> <p>Path within R2 where to put the file.</p> <code>put-path</code> <p>File path where to put the files.</p> <p> Outputs: \u00a4 </p> Name Description <code>cache-hit</code> <p>Returns if the cache was hit or not.</p> Source of <code>Yellow-Dog-Man/composite-actions-templates/.github/actions/download-from-r2@main</code> <pre><code>name: 'R2 download artifact'\ndescription: 'Downloads an artifact from R2.'\n\ninputs:\n  file-path:\n    description: 'Path to the file is.'\n    required: true\n  r2-storage-bucket:\n    description: 'Storage bucket to use to store the artifacts'\n    required: true\n  r2-api-id:\n    description: 'Account ID for R2'\n    required: true\n  r2-auth-token-id:\n    description: 'ID of the authentication token for R2'\n    required: true\n  r2-auth-token:\n    description: 'Authentication token for R2'\n    required: true\n  r2-region:\n    description: 'Region for the R2 account'\n    required: true\n  r2-path:\n    description: 'Path within R2 where to put the file.'\n    required: true\n  put-path:\n    description: 'File path where to put the files.'\n    required: true\n\noutputs:\n  cache-hit:\n    description: 'Returns if the cache was hit or not.'\n    value: ${{ steps.cache-status.outputs.status }}\n\nruns:\n  using: composite\n  steps:\n    - name: 'Install dependencies'\n      shell: bash\n      run: |\n        apt-get update\n        apt-get install -y s3cmd\n\n    - name: 'Get the file'\n      shell: bash\n      id: s3get\n      continue-on-error: true\n      run: s3cmd --access_key=${{ inputs.r2-auth-token-id }} --secret_key=${{ inputs.r2-auth-token }} --region=${{ inputs.r2-region }} --host=https://${{ inputs.r2-api-id }}.r2.cloudflarestorage.com get s3://${{ inputs.r2-storage-bucket }}/github/${{ inputs.file-path }}/files.tar.zstd .\n\n    - name: 'Decompress file to path'\n      shell: bash\n      id: decomp\n      continue-on-error: true\n      run: tar -xf files.tar.zstd -C ${{ inputs.put-path }}\n\n    - name: 'Return cache success'\n      shell: bash\n      id: cache-status\n      run: |\n        if [ \"${{ steps.s3get.conclusion }}\" != \"success\" ] || [ \"${{ steps.decomp.conclusion }}\" != \"success\" ]; then\n          echo \"status=false\" &gt;&gt; $GITHUB_ENV\n        else\n          echo \"status=true\" &gt;&gt; $GITHUB_ENV\n        fi\n</code></pre>"},{"location":"composite/unity-download/","title":"Unity Download &amp; Install","text":"<p>This Composite Action downloads, then installs Unity. Due to its heavy nature, it features heavy caching and will only download Unity from scratch as a last resort.</p> <p>This action is due to be deprecated in the future as we move away from Unity.</p>"},{"location":"composite/unity-download/#.github/actions/unity-download","title":"Download and cache Unity Runtime","text":"<pre><code>- uses: Yellow-Dog-Man/composite-actions-templates/.github/actions/unity-download@main\n</code></pre> <p>Downloads the Unity runtime with heavy caching.</p> <p> Inputs: \u00a4 </p> Name Description Default <code>version</code> <p>The version of Unity to download</p> <code>2019.4.19f1</code> <code>build-target</code> <p>Build target for Unity</p> <code>StandaloneWindows64</code> <code>modules</code> <p>Modules to install, use comma separated list</p> <code>windows-server universal-windows-platform </code> <p> Outputs: \u00a4 </p> Name Description <code>unity-editor-path</code> <p>Path to the Unity editor</p> Source of <code>Yellow-Dog-Man/composite-actions-templates/.github/actions/unity-download@main</code> <pre><code>name: 'Download and cache Unity Runtime'\ndescription: 'Downloads the Unity runtime with heavy caching.'\n\ninputs:\n  version:\n    description: 'The version of Unity to download'\n    required: false\n    default: '2019.4.19f1'\n  build-target:\n    description: 'Build target for Unity'\n    required: false\n    default: 'StandaloneWindows64'\n  modules:\n    description: 'Modules to install, use comma separated list'\n    required: false\n    default: |\n      windows-server\n      universal-windows-platform\n\noutputs:\n  unity-editor-path:\n    description: 'Path to the Unity editor'\n    value: ${{ steps.editor-path.outputs.editor-path }}\n\nruns:\n  using: composite\n  steps:\n    - name: 'Get Unity from cache'\n      uses: actions/cache@v5\n      id: cache\n      with:\n        path: 'C:\\Program Files\\Unity\\'\n        key: ${{ inputs.version }}\n\n    - name: 'setup Unity'\n      if: steps.cache.outputs.cache-hit != 'true'\n      uses: buildalon/unity-setup@v2\n      with:\n        unity-version: ${{ inputs.version }}\n        build-targets: ${{ inputs.build-target }}\n        modules: ${{ inputs.modules }}\n\n    - name: 'Cache Unity'\n      if: steps.cache.outputs.cache-hit != 'true'\n      uses: actions/cache/save@v5\n      with:\n        path: 'C:\\Program Files\\Unity\\'\n        key: ${{ inputs.version }}\n\n    - name: 'Set Unity Editor Path'\n      id: editor-path\n      shell: pwsh\n      run: echo \"editor-path=C:\\Program Files\\Unity\\Hub\\Editor\\${{ inputs.version }}\\Editor\\Unity.exe\" &gt;&gt; $env:GITHUB_OUTPUT\n</code></pre>"},{"location":"composite/upload-to-r2/","title":"Upload artifacts to R2","text":"<p>This Composite Action uploads an artifact to Cloudflare R2.</p>"},{"location":"composite/upload-to-r2/#.github/actions/upload-to-r2","title":"R2 upload artifact","text":"<pre><code>- uses: Yellow-Dog-Man/composite-actions-templates/.github/actions/upload-to-r2@main\n  with:\n    file-path: (1)\n    r2-storage-bucket: (2)\n    r2-api-id: (3)\n    r2-auth-token-id: (4)\n    r2-auth-token: (5)\n    r2-region: (6)\n    r2-path: (7)\n</code></pre> <ol> <li><p>Path to the file being uploaded</p></li> <li><p>Storage bucket to use to store the artifacts</p></li> <li><p>Account ID for R2</p></li> <li><p>ID of the authentication token for R2</p></li> <li><p>Authentication token for R2</p></li> <li><p>Region for the R2 account</p></li> <li><p>Path within R2 where to put the file.</p></li> </ol> <p>Uploads a directory to R2.</p> <p> Inputs: \u00a4 </p> Name Description <code>file-path</code> <p>Path to the file being uploaded</p> <code>r2-storage-bucket</code> <p>Storage bucket to use to store the artifacts</p> <code>r2-api-id</code> <p>Account ID for R2</p> <code>r2-auth-token-id</code> <p>ID of the authentication token for R2</p> <code>r2-auth-token</code> <p>Authentication token for R2</p> <code>r2-region</code> <p>Region for the R2 account</p> <code>r2-path</code> <p>Path within R2 where to put the file.</p> Source of <code>Yellow-Dog-Man/composite-actions-templates/.github/actions/upload-to-r2@main</code> <pre><code>name: 'R2 upload artifact'\ndescription: 'Uploads a directory to R2.'\n\ninputs:\n  file-path:\n    description: 'Path to the file being uploaded'\n    required: true\n  r2-storage-bucket:\n    description: 'Storage bucket to use to store the artifacts'\n    required: true\n  r2-api-id:\n    description: 'Account ID for R2'\n    required: true\n  r2-auth-token-id:\n    description: 'ID of the authentication token for R2'\n    required: true\n  r2-auth-token:\n    description: 'Authentication token for R2'\n    required: true\n  r2-region:\n    description: 'Region for the R2 account'\n    required: true\n  r2-path:\n    description: 'Path within R2 where to put the file.'\n    required: true\n\nruns:\n  using: composite\n  steps:\n    - name: 'Install dependencies'\n      shell: bash\n      run: |\n        apt-get update\n        apt-get install -y s3cmd\n\n    - name: 'Generate zip for files'\n      shell: bash\n      run: tar --zstd -cf files.tar.zstd ${{ inputs.file-path }}\n\n    - name: 'Generate destination dir'\n      id: dest-dir\n      shell: bash\n      run: echo \"directory=github/${{ inputs.r2-path }}\" &gt;&gt; $GITHUB_OUTPUT\n\n    - name: 'Upload files to bucket'\n      shell: bash\n      run: s3cmd --access_key=${{ inputs.r2-auth-token-id }} --secret_key=${{ inputs.r2-auth-token }} --region=${{ inputs.r2-region }} --host=https://${{ inputs.r2-api-id }}.r2.cloudflarestorage.com put files.tar.zstd s3://${{ inputs.r2-storage-bucket }}/${{ steps.dest-dir.outputs.directory }}/\n</code></pre>"},{"location":"workflows/secret-detection/","title":"Secret Detection","text":"<p>This workflow runs secret detection on the target repository.</p> <p>Due to the nature of reusable workflows, you will need to specify <code>secrets: inherit</code> when calling it for GitLeaks to find the license key.</p>"},{"location":"workflows/secret-detection/#.github/workflows/secret-detection.yml","title":"Secret detection on push","text":"<pre><code>uses: Yellow-Dog-Man/composite-actions-templates/.github/workflows/secret-detection.yml@main\npermissions:\n  contents: read\n</code></pre> Source of <code>Yellow-Dog-Man/composite-actions-templates/.github/workflows/secret-detection.yml@main</code> <pre><code>name: 'Secret detection on push'\n\non:\n  push:\n  workflow_call:\n\njobs:\n  gitleaks-scan:\n    runs-on: ubuntu-latest\n\n    permissions:\n      contents: read\n\n    steps:\n      - uses: actions/checkout@v6\n        with:\n          fetch-depth: '0'\n\n      - uses: gitleaks/gitleaks-action@v2\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n          GITLEAKS_LICENSE: ${{ secrets.GITLEAKS_LICENSE }}\n</code></pre>"}]}